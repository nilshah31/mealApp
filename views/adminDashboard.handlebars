<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

<aside class="sidebar-left">
  <nav class="navbar navbar-inverse">
    <div class="container-fluid" style="padding-right:0px;">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="#">Admin Dashboard</a>
      </div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="sidebar-menu">
          <li class="header">MAIN NAVIGATION</li>
          <li>
            <a href="#" id="viewAllOrders">
              <i class="fa fa-shopping-cart"></i> <span>ORDERS</span>
            </a>
          </li>
          <li>
            <a href="#" id="viewAllItem">
              <i class="fa fa-book"></i> <span>Menu Items</span>
            </a>
          </li>
          <li>
            <a href="#" id="viewAllLocation">
              <i class="fa fa-location-arrow"></i><span>Location</span>
            </a>
          </li>
          <li>
            <a href="#" id="viewAllUser">
              <i class="fa fa-user"></i> <span>Users</span>
            </a>
          </li>
          <li>
              <a href="#" onclick="log_out()">
                <form id="logoutAdmin" action="/logoutAdmin" method="post">
                  <i class="fa fa-sign-out"></i>&nbsp;&nbsp;&nbsp;<span>Logout</span>
                </form>
              </a>
          </li>
        </ul>
      </div>
      <!-- /.navbar-collapse -->
    </div>
    <!-- /.container-fluid -->
  </nav>
</aside>

<div class='content container-fluid' style="background-color:#fafafa;">
  <div class="col-sm-12">
  {{#if success_msg}}
  <div class="alert alert-success">
    <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
    {{success_msg}}
  </div>
  {{/if}}

  {{#if error_msg}}
    <div class="alert alert-danger">
      <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
      {{error_msg}}
    </div>
  {{/if}}
</div>
<!--ProgressBar-->
  <div class="col-sm-12">
    <div id="work-in-progress">
      <div class="work-spinner"></div>
    </div>
    <script>
        $(window).bind("load", function () {
            $('#work-in-progress').fadeOut(100);
          });
    </script>
  </div>
  <!--ProgressBar-->

  <div class="col-sm-12">
    {{> adminOrders }}
  </div>
  <div class="col-sm-12">
    {{> adminLocation }}
  </div>
  <div class="col-sm-12">
    {{> adminItems }}
  </div>
  <div class="col-sm-12">
    {{> adminUsers }}
  </div>

  <div class="col-sm-12">
    <footer>
      <p>Made width <i class='fa fa-heart text-danger'></i> By Nil Shah</p>
    </footer>
  </div>
</div>



<script src="http://code.jquery.com/jquery-1.12.4.min.js"></script>
<script src='js/SidebarNav.min.js' type='text/javascript'></script>
<script>
  $('.sidebar-menu').SidebarNav()
</script>







<style>
.wrapper{position:relative}.sidebar-left{background-color:#222d32;margin:0;border:none;border-radius:0}.sidebar-menu{list-style:none;margin:0;padding:0}.sidebar-menu a{color:#b8c7ce;text-decoration:none}.sidebar-menu > li{position:relative;margin:0;padding:0}.sidebar-menu > li > a{padding:12px 5px 12px 15px;display:block;border-left:3px solid transparent}.sidebar-menu > li > a > .fa{width:20px}.sidebar-menu > li:hover > a,.sidebar-menu > li.active > a{color:#fff;background:#1e282c;border-left-color:#3c8dbc}.sidebar-menu > li > .treeview-menu{margin:0 1px;background:#2c3b41}.sidebar-menu > li .label,.sidebar-menu > li .badge{margin-top:3px;margin-right:5px}.sidebar-menu li.header{padding:10px 25px 10px 15px;font-size:12px;color:#4b646f;background:#1a2226}.sidebar-menu li > a > .fa-angle-left{width:auto;height:auto;padding:0;margin-right:10px;margin-top:3px}.sidebar-menu li.active > a > .fa-angle-left{transform:rotate(-90deg)}.sidebar-menu li.active > .treeview-menu{display:block}.sidebar-menu .treeview-menu{display:none;list-style:none;padding:0;margin:0;padding-left:5px}.sidebar-menu .treeview-menu .treeview-menu{padding-left:20px}.sidebar-menu .treeview-menu > li{margin:0}.sidebar-menu .treeview-menu > li > a{padding:5px 5px 5px 15px;display:block;font-size:14px;color:#8aa4af}.sidebar-menu .treeview-menu > li > a > .fa{width:20px}.sidebar-menu .treeview-menu > li > a > .fa-angle-left,.sidebar-menu .treeview-menu > li > a > .fa-angle-down{width:auto}.sidebar-menu .treeview-menu > li.active > a,.sidebar-menu .treeview-menu > li > a:hover{color:#fff}@media (min-width:768px){.sidebar-left{position:absolute;top:0;left:0;bottom:0;width:200px;height:100%;z-index:2016}.sidebar-left .navbar-header{float:none}.sidebar-left .navbar-collapse{padding:0}.content{position:relative;margin-left:200px;height:100%;min-height:100%}}
</style>


<!--Export PDF -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript" src="/js/FileSaver.min.js"></script>
<script type="text/javascript" src="/js/jspdf.min.js"></script>
<script type="text/javascript" src="/js/jspdf.plugin.autotable.js"></script>
<script type="text/javascript" src="/js/tableExport.min.js"></script>
<script src="/js/adminLocation.js"></script>
<script src="/js/admin.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://rawgit.com/notifyjs/notifyjs/master/dist/notify.js"></script>

<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>


<link rel="stylesheet" href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css">

<script>
function DoCellData(cell, row, col, data) {}
function DoBeforeAutotable(table, headers, rows, AutotableSettings) {}
$(".exportButton").on("click", function() {
  $('#myTable').tableExport({type:'pdf',
  drawHeaderRow: function (row, data) {},
  jspdf: {
    theme: 'striped',
    orientation: 'p',
    format: 'a4',
    margins: {left:10, right:10, top:20, bottom:20},
    autotable: {
      styles: {
	       cellPadding: 5, // a number, array or object (see margin below)
         fontSize: 10,
         font: "helvetica", // helvetica, times, courier
         lineColor: 0,
         lineWidth: 0,
         fontStyle: 'normal', // normal, bold, italic, bolditalic
         overflow: 'ellipsize', // visible, hidden, ellipsize or linebreak
         fillColor: 255, // false for transparent or a color as described below
         textColor: 50,
         halign: 'left', // left, center, right
         valign: 'middle', // top, middle, bottom
         columnWidth: 'auto' // 'auto', 'wrap' or a number
      },
      tableWidth: 'auto',
      headerStyles: {
        textColor: 255,
        fontStyle: 'bold',
        halign: 'center'
      },
      showHeader: 'everyPage'
    },
  },
  tableName: 'Report',
  fileName: 'Deleivery Report',
  displayTableName: true
  });
});
</script>

<script>
function deleteItem(obj, id) {
  if(confirm('Are you sure you want to delete this?')){
    $.ajax({
      url: "/dbs/removeItem/"+id,
      type: "POST",
      data: { 'id': id },
      success: function(data){
        $(obj).closest('tr').fadeOut(300,function(){
            $(obj).closest('tr').remove();
        });
        $.notify("Item Removed", "success");
      },
    });
  }
}

function deleteLocation(obj, id) {
  if(confirm('Are you sure you want to delete this?')){
    $.ajax({
      url: "/dbs/removeLocation/"+id,
      type: "POST",
      data: { 'id': id },
      success: function(data){
        $(obj).closest('tr').fadeOut(300,function(){
            $(obj).closest('tr').remove();
        });
        $.notify("Item Removed", "success");
      },
    });
  }
}

function addLocation() {
  $.ajax({
      url: "/dbs/addLocation",
      type: "POST",
      data: { 'city': $('#cityTxtBox').val(), 'company': $('#locationTxtBox').val() },
      success: function(data){
        $('#locationListTable').append('<tr>' +
          '<td><input type="checkbox" checked/></td>' +
          '<td>'+ $('#cityTxtBox').val()+'</td>' +
          '<td>'+ $('#locationTxtBox').val()+'</td>' +
          '<td>'+
            '<div class="link_edit">'+
              '<a class="btnEdit" href="#" id="editItem" onclick="edit_location(\''+data+'\',\''+$('#cityTxtBox').val()+'\',\''+$('#locationTxtBox').val()+'\')">'+
                  '<i class="fa fa-edit" title="Edit Item Detail"></i>'+
              '</a>'+
            '</div>'+
          '</td>'+
          '<td>'+
            '<button onclick="deleteLocation(this,\''+data+'\')">Remove</button>'+
          '</td>'+
          '</tr>');
        $('#locationModal').hide();
        $.notify("Location Added", "success");
      }
  });
}
</script>


<script>
$('#filterOrderTableWithOption').on('change', function(){
    selectedOption = $(this).val();
    selectedLocation = $('#filterLocation').val();
    if(selectedOption==0)filterOrderTableData(0,'myInput5',selectedLocation);
    if(selectedOption==1)searchTodaysOrder(8,'myInput6','myInput3',selectedLocation);
    if(selectedOption==2)searchTodaysOrder(8,'myInput4','myInput3',selectedLocation);
});
$('#myInput1').keyup(function() {
    selectedLocation = $('#filterLocation').val();
    filterOrderTableData(0,'myInput1',selectedLocation)
});
$('#myInput2').keyup(function() {
    selectedLocation = $('#filterLocation').val();
    filterOrderTableData(0,'myInput2',selectedLocation)
});
</script>

<link href="http://www.jquery-az.com/jquery/css/jquery.multiselect.css" rel="stylesheet" type="text/css">
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="http://www.jquery-az.com/jquery/js/multiselect-checkbox/jquery.multiselect.js"></script>
<script src="https://rawgit.com/notifyjs/notifyjs/master/dist/notify.js"></script>

{{#each locationList}}
  <script>
    $('<option value="{{_id}}">{{company}}</option>').appendTo('#multicheckboxLocation');
  </script>
{{/each}}

<script>
$('select[multiple]').multiselect({
    columns: 1
});

$('#multicheckboxLocation').on('change', function() {
  item_id = $('#multicheckboxLocation').attr("name");;
  $("#multicheckboxLocation option:selected").each(function(){
    location_id = $(this).val();
    $.ajax({
        url: "/dbs/addLocationtoMenu",
        type: "POST",
        data: { 'item_id': item_id, 'location_id': location_id },
        success: function(data){
          $.notify("Location Added Successfully", "success");
        },
    });
  });
  $("#multicheckboxLocation option:not(:selected)").each(function(){
    location_id = $(this).val();
    $.ajax({
        url: "/dbs/removeLocationtoMenu",
        type: "POST",
        data: { 'item_id': item_id, 'location_id': location_id },
        success: function(data){
        },
    });
  });

  //$(this).placeholder("");
})

</script>
