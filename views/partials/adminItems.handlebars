<!--Item DIV -->
<div id="itemDIV">
    <form method="post" action="/delete_multiple_items" style="margin:0px" id="delete_multiple_item" name="delete_multiple_item">
    <a class="btn btn-success toright" href="#" id="addItem">
        <i class="fa fa-plus" aria-hidden="true"></i>Add Item to Catalog
    </a>
    <input type="hidden" name="delete_all_items_ids" id="delete_all_items_ids"/>
    <a href="#" class="btn btn-success toright" onclick="deleteitemsAll()">
        <i class="fa fa-times" aria-hidden="true"></i>Remove Selected
    </a>
    </form>
    <br /><br />

    <div class="box box-primary" id="box_orders">
        <div class="box-header with-border">
            <h3 class="box-title">Available Item's</h3>
        </div>
    </div>
    <form method="post" action="/item_list_form" style="margin:0px" id="item_list_form" name="item_list_form" return>
    <input type='hidden' id='item_ID' name="item_ID" value='' />
        <table border="0" cellpadding="0" cellspacing="1" class="table_admin table table-striped table-hover" style="width:100%">
            <tr>
                <th><input type="checkbox" id="checkAllItems" name="checkAllItems" /></th>
                <th>Menu Item's</th>
                <th width="50%" class="hidden-phone hidden-tablet">Name</th>
                <th width="50%" class="hidden-phone hidden-tablet">Description</th>
                <th>Price</th>
                <th>Initial Qty</th>
                <th>Image</th>
                <th></th>
                <th></th>
            </tr>
            {{#each itemList}}
                <tr valign="top" >
                    <input type="hidden" value="{{_id}}" name="itemIDS" />
                    <td><input type="checkbox" value="{{_id}}" id="checkAllItems" class="checkAllItemsSingle" name="checkAllItems"></td>
                    <td><input type="checkbox" id="menuItems" value="{{_id}}" name="menuItems"></td>
                    <td>{{name}}</td>
                    <td>{{description}}</td>
                    <td>{{price}}</td>
                    <td>{{initial_qty}}</td>
                    <td><img src='{{item_image_path}}' alt="Menu Item" height="42" width="42"></td>
                    <td><div class="link_edit"><a class="btnEdit" href="#" id="editItem" onclick="edit_item('{{_id}}',
                            '{{name}}','{{description}}','{{price}}','{{initial_qty}}')">Edit</a></div></td>
                    <td><div class="link_delete"><a href="#" onclick="delete_item('{{_id}}')">Delete</a></div></td>
                </tr>
            {{/each}}
        </table>
    </form>
</div>

<!-- New Item Form -->
<div id="itemModal" class="modal">
    <div class="item-modal-content">
        <span class="close">&times;</span>
        <h1>New Item</h1>
        <form method="post" name="itemForm" action="/newItem" class="newItem" enctype="multipart/form-data">
            <fieldset>
                <label for="name">Name : </label>
                <input type="text" name="itemNameTxtBox" id="itemNameTxtBox" required>
                <label for="descript ion">Description : </label>
                <input type="text" name="descTxtBox" id="descTxtBox" required>
                <label for="price">Price : </label>
                <input type="text" name="priceTxtBox"  pattern="\d*" id="priceTxtBox" required>
                <label for="initial_qty">Initial Quantity : </label>
                <input type="text" name="inititalQtyTxtBox"  pattern="\d*" id="inititalQtyTxtBox" required>

                <label for="category">Select Category : </label>
                <select name="category" id="category" class="form-control input-md" required>
                    <option>Veg</option>
                    <option>Non-Veg</option>
                </select>
                <br />
                <label for="item_img">Image : </label>
                <input type="file" accept="image/*" name="item_img" required>
                <br />
                <input type="submit" class="item-modal-content-submit bg-green newItem">
            </fieldset>
        </form>
    </div>
</div>


<!-- Edit Item Form -->
<div id="editItemModal" class="modal">
    <div class="item-modal-content">
        <span class="close">&times;</span>
        <h1>Edit Item</h1>
        <form method="post" name="edititemForm" action="/editItem" class="newItem" enctype="multipart/form-data">
            <fieldset>
                <input type="hidden" name="editItemId" id="editItemId" />
                <label for="name">Name : </label>
                <input type="text" name="edititemNameTxtBox" id="edititemNameTxtBox" require>
                <label for="descript ion">Description : </label>
                <input type="text" name="editdescTxtBox" id="editdescTxtBox" require>
                <label for="price">Price : </label>
                <input type="text" name="editpriceTxtBox" id="editpriceTxtBox" require>
                <label for="initial_qty">Initial Quantity : </label>
                <input type="text" name="editinititalQtyTxtBox" id="editinititalQtyTxtBox" require>
                <label for="item_img">Image : </label>
                <input type="file" accept="image/*" name="edit_item_img">
                <br />
                <input type="submit" class="item-modal-content-submit bg-green newItem">
            </fieldset>
        </form>
    </div>
</div>


<script>
    function delete_item(item_id) {
        if(confirm("Do you want to delete this Item ?")) {
            document.getElementById('item_ID').value = item_id;
            document.getElementById("item_list_form").submit();
        }
    }
    
    function deleteitemsAll() {
        if(confirm("Do you want to delete all this Item ?")) {
            getCheckedBoxes('checkAllItems');
            document.getElementById("delete_multiple_item").submit();
        }
    }


    // Pass the checkbox name to the function
    function getCheckedBoxes(chkboxName) {
        var checkboxes = document.getElementsByName(chkboxName);
        var checkboxesChecked = [];
        var id_hidden_ob = document.getElementById('delete_all_items_ids');
        // loop over them all
        for (var i=1; i<checkboxes.length; i++) {
            // And stick the checked ones onto an array...
            if (checkboxes[i].checked) {
                id_hidden_ob.value+=","+checkboxes[i].value;
            }
        }
    }

    $(document).ready(function() {
        $("#checkAllItems").change(function(){
            if(this.checked){
                $(".checkAllItemsSingle").each(function(){
                    this.checked=true;
                })
            }else{
                $(".checkAllItemsSingle").each(function(){
                    this.checked=false;
                })
            }
        });

        $(".checkAllItemsSingle").click(function () {
            if ($(this).is(":checked")){
                var isAllChecked = 0;
                $(".checkAllItemsSingle").each(function(){
                    if(!this.checked)
                        isAllChecked = 1;
                })
                if(isAllChecked == 0){ $("#checkAllItems").prop("checked", true); }
            }else {
                $("#checkAllItems").prop("checked", false);
            }
        });
    });
</script>



<script>

    function edit_item(item_id, item_name, desc, price, init_qty) {
        document.getElementById('edititemNameTxtBox').value=item_name;
        document.getElementById('editdescTxtBox').value=desc;
        document.getElementById('editpriceTxtBox').value=price;
        document.getElementById('editinititalQtyTxtBox').value=init_qty;
        document.getElementById('editItemId').value=item_id;

        // Get the modal
        var modal6 = document.getElementById('editItemModal');

        // Get the <span> element that closes the modal
        var span6 = document.getElementsByClassName("close")[3];

        modal6.style.display = "block";

        // When the user clicks on <span> (x), close the modal
        span6.onclick = function () {
            modal6.style.display = "none";
        }

        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function (event) {
            if (event.target == modal6) {
                modal6.style.display = "none";
            }
        }
    }
</script>
